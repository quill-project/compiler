<!doctype html>
<html>
<head>
    <script src="quill.js"></script>
    <script>

    const print = thing => console.log(thing);
    const add = (a, b) => a + b;
    const sqrt = x => Math.sqrt(x);
    const PI = Math.PI;

    const sources = {
        "test.quill": `

mod js

pub ext fun print_int(n: Int) = print
pub ext fun print_float(x: Float) = print
pub ext fun add_int(a: Int, b: Int) -> Int = add
pub ext fun add_float(a: Float, b: Float) -> Float = add
pub ext fun sqrt(x: Float) -> Float = sqrt
pub ext val PI: Float = PI


mod test

use js::(print_int, print_float, PI as pi)

fun fib(n: Int) -> Int =
    if n <= 1 { n }
    else { fib(n - 1) + fib(n - 2) }

fun main() {
    print_float(3.5)
    print_int(fib(10))
}

fun double(a: Float) -> Float = a * 2.0

val TAU: Float = test::double(pi)

        `
    };

    const result = quill.compile(sources);
    if(result.success) {
        console.log(result.code);
        eval(result.code);
        test$main();
    } else {
        console.log(result.errors
            .map(e => quill.message.display(e, sources))
            .join("\n\n")
        );
    }
    </script>
</head>
<body></body>
</html>